<html>
<head id="ctl00_ctl00_Head1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">


<meta name="wpd_version" content="0.2">
<meta name="wpd_baseurl" content="http://www.blackwasp.co.uk/WPFMouseBindings.aspx">
<meta name="wpd_url" content="http://www.blackwasp.co.uk/WPFMouseBindings.aspx">
<meta name="wpd_date" content="2018-02-28T22:08Z">
<script src="300lo.json" type="text/javascript"></script><script src="_ate.track.config_resp" type="text/javascript"></script><script src="ga.js" async="" type="text/javascript"></script><script type="text/javascript" src="widgets.js"></script><script type="text/javascript" src="300lo_001.json"></script><script type="text/javascript" src="_ate.track.config_resp"></script><link rel="alternate" type="application/rss+xml" title="BlackWasp Latest Additions" href="http://feeds.feedburner.com/BlackwaspLatestAdditions">
<script type="text/javascript" async="" src="ga.js"></script><script type="text/javascript">var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-784824-7']); _gaq.push(['_trackPageview']); (function () { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })();</script>
<link href="http://www.blackwasp.co.uk/WPFMouseBindings.aspx" rel="canonical"><meta name="Description" content="The one hundred and sixty-seventh part of the Windows Presentation Foundation Fundamentals tutorial is the last article to describe WPF commanding. This instalment explains how mouse actions can be used to execute commands."><title>

	WPF Commanding - Mouse Bindings
</title><script type="text/javascript" id="cosymantecbfw_removeToolbar">(function () {				var toolbarElement = {},					parent = {},					interval = 0,					retryCount = 0,					isRemoved = false;				if (window.location.protocol === 'file:') {					interval = window.setInterval(function () {						toolbarElement = document.getElementById('coFrameDiv');						if (toolbarElement) {							parent = toolbarElement.parentNode;							if (parent) {								parent.removeChild(toolbarElement);								isRemoved = true;								if (document.body && document.body.style) {									document.body.style.setProperty('margin-top', '0px', 'important');								}							}						}						retryCount += 1;						if (retryCount > 10 || isRemoved) {							window.clearInterval(interval);						}					}, 10);				}			})();</script><script type="text/javascript" charset="utf-8" async="" src="132.2a5f921bf975616ac768.js"></script><script type="text/javascript" id="waxCS">var WAX = function () { var _arrInputs; return { getElement: function (i) { return _arrInputs[i]; }, setElement: function(i){ _arrInputs=i; } } }(); function waxGetElement(i) { return WAX.getElement(i); } function coSetPageData(t, d){ if('wax'==t) { WAX.setElement(d);} }</script><script type="text/javascript" charset="utf-8" async="" src="button.b74390cfaab5c0218a0e372047007e13.js"></script><script type="text/javascript" id="waxCS">var WAX = function () { var _arrInputs; return { getElement: function (i) { return _arrInputs[i]; }, setElement: function(i){ _arrInputs=i; } } }(); function waxGetElement(i) { return WAX.getElement(i); } function coSetPageData(t, d){ if('wax'==t) { WAX.setElement(d);} }</script>
<link rel="stylesheet" type="text/css" href="WPFMouseBindings.css" media="all">
</head>
<body><form name="aspnetForm" method="post" action="http://www.blackwasp.co.uk/Article.aspx?page=WPFMouseBindings&amp;number=1" id="aspnetForm">
<div>
<input name="__EVENTTARGET" id="__EVENTTARGET" value="" type="hidden">
<input name="__EVENTARGUMENT" id="__EVENTARGUMENT" value="" type="hidden">
<input name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUKMTkzNjQ3NDc4NGRkJRsxC+KN1LVsWGxkpU897nk0SM0a3uoB0ey8fYgXVcI=" type="hidden">
</div>

<script type="text/javascript">

//<![CDATA[
var theForm = document.forms['aspnetForm'];
if (!theForm) {
    theForm = document.aspnetForm;
}
function __doPostBack(eventTarget, eventArgument) {
    if (!theForm.onsubmit || (theForm.onsubmit() != false)) {
        theForm.__EVENTTARGET.value = eventTarget;
        theForm.__EVENTARGUMENT.value = eventArgument;
        theForm.submit();
    }
}
//]]>
</script>


<div>

	<input name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="2173C2F0" type="hidden">
	<input name="__EVENTVALIDATION" id="__EVENTVALIDATION" value="/wEdAAQbFQNQI2OUZ+5PdjaymPxt5uR+lcpVQHqMDkiJId+TtcEVmI3aJcQdmuXHemHELFAq+2fLTfvIFSBV2B9ev0e+s4cRf4Sg+nU6Irpm0R2u66ODHaeQ6/+jJJZduEY8428=" type="hidden">
</div>
<div class="wrapper"><div class="header"><a href="http://www.blackwasp.co.uk/Default.aspx"><img src="Logo.png" alt="BlackWaspTM" style="border: medium none; float: left;" height="90" width="218"></a>
</div>
<div class="menu"><div class="menuitem"><a href="http://www.blackwasp.co.uk/Default.aspx">Home</a></div><div class="menuitem"><a href="http://www.blackwasp.co.uk/Articles.aspx">Articles</a></div><div class="menuitem"><a href="http://www.blackwasp.co.uk/Tutorials.aspx">Tutorials</a></div><div class="menuitem"><a href="http://www.blackwasp.co.uk/FAQ.aspx">FAQ</a></div><div class="menuitem"><a href="http://www.blackwasp.co.uk/Contact.aspx">Contact</a></div><div id="ctl00_ctl00_SearchArea" class="searchbox"><input name="ctl00$ctl00$q" maxlength="512" id="ctl00_ctl00_q" class="searchtext" onkeypress="javascript:if (event.keyCode == 13) __doPostBack('ctl00$ctl00$SearchButton','')" type="text"><a id="ctl00_ctl00_SearchButton" class="searchbutton" href="javascript:__doPostBack('ctl00$ctl00$SearchButton','')">Search</a></div></div>
<div class="shadow"></div><div class="content">
<div id="cookiebanner" style="background-color: Yellow; border: 1px solid rgb(128, 128, 128); border-radius: 6px; box-shadow: 3px 3px 3px gray; margin-bottom: 15px;"><p style="line-height: 1em; margin: 8px; padding: 2px;"><input style="float: right; margin-left: 20px;" onclick="document.getElementById('cookiebanner').style.display='none'" value="Hide" type="button">This web site uses cookies. By using the site you accept the <a href="http://www.blackwasp.co.uk/Cookies.aspx">cookie policy</a>.<span style="display: block; font-size: 85%;">This message is for compliance with the <a href="https://templatearchive.com/ico-cookies-guidance/" target="_top">UK ICO law</a>.</span></p></div>
<div id="atdiv" class="addthis_toolbox addthis_default_style addthis_16x16_style"><a class="addthis_button_facebook_like at300b"><div class="fb-like fb_iframe_widget" data-layout="button_count" data-show_faces="false" data-share="false" data-action="like" data-width="90" data-height="25" data-font="arial" data-href="http://www.blackwasp.co.uk/WPFMouseBindings.aspx" data-send="false" style="height: 25px;" fb-xfbml-state="rendered" fb-iframe-plugin-query="action=like&amp;app_id=172525162793917&amp;container_width=61&amp;font=arial&amp;height=25&amp;href=http%3A%2F%2Fwww.blackwasp.co.uk%2FWPFMouseBindings.aspx&amp;layout=button_count&amp;locale=en_US&amp;sdk=joey&amp;send=false&amp;share=false&amp;show_faces=false&amp;width=90"><span style="vertical-align: bottom; width: 61px; height: 20px;"><iframe name="f3a882563167ad4" allowtransparency="true" allowfullscreen="true" scrolling="no" title="fb:like Facebook Social Plugin" src="WPFMouseBindings_1.html" style="border: medium none; visibility: visible; width: 61px; height: 20px;" class="" frameborder="0" height="25px" width="90px"></iframe></span></div></a><a class="addthis_button_tweet at300b"><div class="tweet_iframe_widget" style="width: 62px; height: 25px;"><span><iframe id="twitter-widget-0" scrolling="no" allowtransparency="true" class="twitter-share-button twitter-share-button-rendered twitter-tweet-button" title="Twitter Tweet Button" src="WPFMouseBindings_2.html" style="position: static; visibility: visible; width: 60px; height: 20px;" data-url="http://www.blackwasp.co.uk/WPFMouseBindings.aspx#.WrwSItr4ICk.twitter" frameborder="0"></iframe></span></div></a><a class="addthis_button_google_plusone_share at300b" target="_top" title="Google+" href="#"><span class="at-icon-wrapper" style="background-color: rgb(220, 78, 65); line-height: 16px; height: 16px; width: 16px;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" version="1.1" role="img" aria-labelledby="at-svg-google_plusone_share-1" title="Google+" alt="Google+" class="at-icon at-icon-google_plusone_share" style="width: 16px; height: 16px;"><title id="at-svg-google_plusone_share-1">Google+</title><g><path d="M12 15v2.4h3.97c-.16 1.03-1.2 3.02-3.97 3.02-2.39 0-4.34-1.98-4.34-4.42s1.95-4.42 4.34-4.42c1.36 0 2.27.58 2.79 1.08l1.9-1.83C15.47 9.69 13.89 9 12 9c-3.87 0-7 3.13-7 7s3.13 7 7 7c4.04 0 6.72-2.84 6.72-6.84 0-.46-.05-.81-.11-1.16H12zm15 0h-2v-2h-2v2h-2v2h2v2h2v-2h2v-2z" fill-rule="evenodd"></path></g></svg></span></a><a class="addthis_button_linkedin at300b" target="_top" title="LinkedIn" href="#"><span class="at-icon-wrapper" style="background-color: rgb(0, 119, 181); line-height: 16px; height: 16px; width: 16px;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" version="1.1" role="img" aria-labelledby="at-svg-linkedin-2" title="LinkedIn" alt="LinkedIn" class="at-icon at-icon-linkedin" style="width: 16px; height: 16px;"><title id="at-svg-linkedin-2">LinkedIn</title><g><path d="M26 25.963h-4.185v-6.55c0-1.56-.027-3.57-2.175-3.57-2.18 0-2.51 1.7-2.51 3.46v6.66h-4.182V12.495h4.012v1.84h.058c.558-1.058 1.924-2.174 3.96-2.174 4.24 0 5.022 2.79 5.022 6.417v7.386zM8.23 10.655a2.426 2.426 0 0 1 0-4.855 2.427 2.427 0 0 1 0 4.855zm-2.098 1.84h4.19v13.468h-4.19V12.495z" fill-rule="evenodd"></path></g></svg></span></a><a class="addthis_button_stumbleupon at300b" target="_top" title="StumbleUpon" href="#"><span class="at-icon-wrapper" style="background-color: rgb(235, 73, 36); line-height: 16px; height: 16px; width: 16px;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" version="1.1" role="img" aria-labelledby="at-svg-stumbleupon-3" title="StumbleUpon" alt="StumbleUpon" class="at-icon at-icon-stumbleupon" style="width: 16px; height: 16px;"><title id="at-svg-stumbleupon-3">StumbleUpon</title><g><path d="M17.17 14.29l1.5.7 2.234-.665v-1.558C20.904 10.12 18.67 8 16 8c-2.658 0-4.904 2.108-4.904 4.732v7.104c0 .654-.527 1.17-1.17 1.17-.64 0-1.168-.516-1.168-1.17v-3.002H5v3.048c0 2.716 2.2 4.916 4.916 4.916 2.692 0 4.915-2.166 4.915-4.847v-7.01c0-.643.528-1.17 1.17-1.17.642 0 1.17.527 1.17 1.17v1.35zm6.072 2.544v3.15c0 .643-.527 1.16-1.17 1.16-.64 0-1.168-.517-1.168-1.16v-3.092l-2.234.664-1.5-.7v3.072c0 2.693 2.21 4.87 4.914 4.87 2.716 0 4.916-2.2 4.916-4.916v-3.048h-3.758z" fill-rule="evenodd"></path></g></svg></span></a><a class="addthis_button_dotnetshoutout"></a><a class="addthis_button_dzone"></a><a class="addthis_button_email at300b" target="_top" title="Email" href="#"><span class="at-icon-wrapper" style="background-color: rgb(132, 132, 132); line-height: 16px; height: 16px; width: 16px;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" version="1.1" role="img" aria-labelledby="at-svg-email-4" title="Email" alt="Email" class="at-icon at-icon-email" style="width: 16px; height: 16px;"><title id="at-svg-email-4">Email</title><g><g fill-rule="evenodd"></g><path d="M27 22.757c0 1.24-.988 2.243-2.19 2.243H7.19C5.98 25 5 23.994 5 22.757V13.67c0-.556.39-.773.855-.496l8.78 5.238c.782.467 1.95.467 2.73 0l8.78-5.238c.472-.28.855-.063.855.495v9.087z"></path><path d="M27 9.243C27 8.006 26.02 7 24.81 7H7.19C5.988 7 5 8.004 5 9.243v.465c0 .554.385 1.232.857 1.514l9.61 5.733c.267.16.8.16 1.067 0l9.61-5.733c.473-.283.856-.96.856-1.514v-.465z"></path></g></svg></span></a><a class="addthis_button_favorites at300b" title="Favorites" href="#"><span class="at-icon-wrapper" style="background-color: rgb(245, 202, 89); line-height: 16px; height: 16px; width: 16px;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" version="1.1" role="img" aria-labelledby="at-svg-favorites-5" title="Favorites" alt="Favorites" class="at-icon at-icon-favorites" style="width: 16px; height: 16px;"><title id="at-svg-favorites-5">Favorites</title><g><path d="M26.56 13.56a.432.432 0 0 0-.4-.29h-7.51l-2.32-7.14c-.06-.17-.22-.28-.39-.28s-.34.11-.39.28l-2.34 7.14H5.72c-.18 0-.34.12-.39.29-.06.17.01.35.15.46l6.06 4.42-2.34 7.17c-.06.17.01.35.15.46.14.11.34.1.49 0l6.1-4.43 6.09 4.43c.07.05.16.08.24.08s.17-.03.24-.08c.15-.1.2-.29.15-.46l-2.34-7.18 6.08-4.42a.37.37 0 0 0 .16-.45z"></path></g></svg></span></a><div class="atclear"></div></div>
<div class="community"><script type="text/javascript">var addthis_exclude = 'print,instapaper,pdfonline,pdfmyurl'</script>
<script type="text/javascript" src="addthis_widget.js"></script></div>
<script type="text/javascript">var url = document.URL.split('#')[0];
var urlParts = url.split('_');
if (urlParts.length == 2) { url = urlParts[0] + ".aspx"; }
var titleParts = document.title.split('(');
if (titleParts.length == 1) { titleParts = title.split(':'); }
title = titleParts[0];
var atctl = document.getElementById('atdiv');
atctl.setAttribute("addthis:url", url);
atctl.setAttribute("addthis:title", title);</script>
<article><header><span class="articleicon"><img src="WPF.png" alt="Windows Presentation Foundation"><br>.NET 4.0+</span><h1>WPF Commanding - Mouse Bindings</h1><div class="author">by <a rel="author" href="https://profiles.google.com/113882985360066691734">Richard Carr</a>, published at <a id="ctl00_ctl00_PageContent_PageContent_PublishedAtLink" href="http://www.blackwasp.co.uk/WPFMouseBindings.aspx">http://www.blackwasp.co.uk/WPFMouseBindings.aspx</a></div><p><em>The one hundred and sixty-seventh part of the <a href="http://www.blackwasp.co.uk/WPFTutorial.aspx">Windows Presentation Foundation Fundamentals tutorial</a> is the last article to describe WPF commanding. This instalment explains how mouse actions can be used to execute commands.</em></p></header><div id="ctl00_ctl00_PageContent_PageContent_PreviousLinkDiv" class="navback"><a href="http://www.blackwasp.co.uk/WPFKeyBindings.aspx" id="ctl00_ctl00_PageContent_PageContent_PreviousLink">Previous: WPF Commanding - Keyboard Shortcuts</a></div><div id="ctl00_ctl00_PageContent_PageContent_DownloadLinkDiv" class="dl"><a id="ctl00_ctl00_PageContent_PageContent_DownloadButton" href="javascript:__doPostBack('ctl00$ctl00$PageContent$PageContent$DownloadButton','')">Download Source Code</a></div>
<h2>Mouse Bindings</h2>
<p>In the last instalment in the <a href="http://www.blackwasp.co.uk/WPF.aspx">WPF</a> tutorial we saw how <a href="http://www.blackwasp.co.uk/WPFKeyBindings.aspx">key bindings</a> could be employed to allow users to execute <a href="http://www.blackwasp.co.uk/WPFCommands.aspx">commands</a> using keyboard shortcuts. A similar type of input binding can be used with mouse actions, allowing you to detect when the user clicks any of the three main mouse buttons, double-clicks a button or moves the mouse wheel.</p>
<p><em>Mouse bindings</em>, like key bindings, are applied to any control or other object that <a href="http://www.blackwasp.co.uk/Inheritance.aspx">inherits</a> from the <em><a href="http://www.blackwasp.co.uk/UIElement.aspx">UIElement</a></em> class. They are added to the item's <em>InputBindings</em> collection. In this article we'll demonstrate mouse bindings by applying several to a simple command and a basic <a href="http://www.blackwasp.co.uk/WPFWindow.aspx">window</a>.</p>
<p>To begin, create a new <a href="http://www.blackwasp.co.uk/WPFinVS.aspx">WPF application in Visual Studio</a> named, "MouseBindingDemo". Once the solution is ready, replace the <a href="http://www.blackwasp.co.uk/XAML.aspx">XAML</a> in the main window with the code below. This creates a window containing a <a href="http://www.blackwasp.co.uk/WPFLabel.aspx">Label</a>.</p>
<div class="code"><div><div id="highlighter_324829" class="syntaxhighlighter nogutter  xml"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">&lt;</code><code class="xml keyword">Window</code> <code class="xml color1">x:Class</code><code class="xml plain">=</code><code class="xml string">"MouseBindingDemo.MainWindow"</code></div><div class="line number2 index1 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color1">xmlns</code><code class="xml plain">=</code><code class="xml string">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</code></div><div class="line number3 index2 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color1">xmlns:x</code><code class="xml plain">=</code><code class="xml string">"http://schemas.microsoft.com/winfx/2006/xaml"</code></div><div class="line number4 index3 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color1">Title</code><code class="xml plain">=</code><code class="xml string">"MouseBinding Demo"</code> <code class="xml color1">Height</code><code class="xml plain">=</code><code class="xml string">"200"</code> <code class="xml color1">Width</code><code class="xml plain">=</code><code class="xml string">"250"</code><code class="xml plain">&gt;</code></div><div class="line number5 index4 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">Label</code> <code class="xml color1">HorizontalAlignment</code><code class="xml plain">=</code><code class="xml string">"Center"</code> <code class="xml color1">VerticalAlignment</code><code class="xml plain">=</code><code class="xml string">"Center"</code><code class="xml plain">&gt;Mouse Binding Demo&lt;/</code><code class="xml keyword">Label</code><code class="xml plain">&gt;</code></div><div class="line number6 index5 alt1"><code class="xml plain">&lt;/</code><code class="xml keyword">Window</code><code class="xml plain">&gt;</code></div></div></td></tr></tbody></table></div></div></div>
<p>As with the previous article, let's create a simple custom command that shows the contents of its provided parameter. Add the following <a href="http://www.blackwasp.co.uk/CSharpSimpleClass.aspx">class</a> to the project.</p>
<div class="code"><div><div id="highlighter_786398" class="syntaxhighlighter nogutter  csharp"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="csharp keyword">public</code> <code class="csharp keyword">class</code> <code class="csharp plain">MessageCommand : ICommand</code></div><div class="line number2 index1 alt1"><code class="csharp plain">{</code></div><div class="line number3 index2 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">void</code> <code class="csharp plain">Execute(</code><code class="csharp keyword">object</code> <code class="csharp plain">parameter)</code></div><div class="line number4 index3 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number5 index4 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">MessageBox.Show(parameter.ToString());</code></div><div class="line number6 index5 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">bool</code> <code class="csharp plain">CanExecute(</code><code class="csharp keyword">object</code> <code class="csharp plain">parameter)</code></div><div class="line number9 index8 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number10 index9 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">return</code> <code class="csharp keyword">true</code><code class="csharp plain">;</code></div><div class="line number11 index10 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp keyword">event</code> <code class="csharp plain">EventHandler CanExecuteChanged;</code></div><div class="line number14 index13 alt1"><code class="csharp plain">}</code></div></div></td></tr></tbody></table></div></div></div>
<p>To allow the window access to the command, we'll create a new class that will be the basis of the window's <a href="http://www.blackwasp.co.uk/WPFDataContext.aspx">data context</a>. This includes a <a href="http://www.blackwasp.co.uk/CSharpClassProperties.aspx">property</a> that provides an instance of the <em>MessageCommand</em> class.</p>
<p>Create a new class file named, "MyDataContext" and update the code, as follows:</p>
<div class="code"><div><div id="highlighter_346591" class="syntaxhighlighter nogutter  csharp"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="csharp keyword">public</code> <code class="csharp keyword">class</code> <code class="csharp plain">MyDataContext</code></div><div class="line number2 index1 alt1"><code class="csharp plain">{</code></div><div class="line number3 index2 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">ICommand _messageCommand = </code><code class="csharp keyword">new</code> <code class="csharp plain">MessageCommand();</code></div><div class="line number4 index3 alt1"><code class="csharp spaces">&nbsp;</code>&nbsp;</div><div class="line number5 index4 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">public</code> <code class="csharp plain">ICommand MessageCommand</code></div><div class="line number6 index5 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number7 index6 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">get</code> <code class="csharp plain">{ </code><code class="csharp keyword">return</code> <code class="csharp plain">_messageCommand; }</code></div><div class="line number8 index7 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number9 index8 alt2"><code class="csharp plain">}</code></div></div></td></tr></tbody></table></div></div></div>
<p>Finally, to link all of the items together, update the <a href="http://www.blackwasp.co.uk/CSharpConstructors.aspx">constructor</a> of the main window, as shown below. This creates a new instance of the <em>MyDataContext</em> class and assigns it to the data context of the window.</p>
<div class="code"><div><div id="highlighter_65763" class="syntaxhighlighter nogutter  csharp"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="csharp keyword">public</code> <code class="csharp plain">MainWindow()</code></div><div class="line number2 index1 alt1"><code class="csharp plain">{</code></div><div class="line number3 index2 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">InitializeComponent();</code></div><div class="line number4 index3 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">DataContext = </code><code class="csharp keyword">new</code> <code class="csharp plain">MyDataContext();</code></div><div class="line number5 index4 alt2"><code class="csharp plain">}</code></div></div></td></tr></tbody></table></div></div></div>
<h3>Adding Mouse Bindings</h3>
<p>Creating and using a mouse binding is very similar to the process for key bindings. You create a new <em>MouseBinding</em> object and add this to the target element's <em>InputBindings</em> collection. The action applies to the control that references it and its children within the logical tree.</p>
<p>To identify the control to execute, you set the <em>Command</em> property of the binding. This can specify a built-in command from the .NET framework or can be a <a href="http://www.blackwasp.co.uk/WPFDataBinding.aspx">binding expression</a> that locates a <a href="http://www.blackwasp.co.uk/WPFCustomCommands.aspx">custom command</a>. Optionally, you can include a <em>CommandParameter</em> property. The contents of this property are passed to the command when it is run and when checking if it can be executed.</p>
<p>In addition to the command, you must specify the mouse action that you wish to capture. You can do this using the <em>MouseAction</em> member of the mouse binding. The property should be set to a value from the <em>MouseAction</em> <a href="http://www.blackwasp.co.uk/CSharpConstAndEnums.aspx">enumeration</a>. The actions that can be intercepted are:</p>
<ul><li><strong>LeftClick</strong>. Specifies that single left button clicks should be captured.</li><li><strong>MiddleClick</strong>. Use this option to detect when the user clicks the middle button, which is often the mouse wheel.</li><li><strong>RightClick</strong>. This option is used to capture the user clicking the right mouse button.</li><li><strong>WheelClick</strong>. A mouse binding to the WheelClick option causes the command to execute when the mouse wheel is rotated.</li><li><strong>LeftDoubleClick</strong>. Specifies that the command should run in response to the user double-clicking the left mouse button.</li><li><strong>MiddleDoubleClick</strong>. This option is used to identify the user double-clicking the middle button.</li><li><strong>RightDoubleClick</strong>. The final option runs the command when the right button is double-clicked.</li></ul>
<p><em>NB: Left and Right are not ideal descriptions for the enumeration constants. If the user has reversed the operation of the mouse buttons in the operating system configuration, the LeftClick and LeftDoubleClick options will respond to the user clicking the right button. "Left" always signifies the primary button.</em></p>
<p>Let's define some mouse bindings. Create the following <em>Window.InputBindings</em> element. This captures double-clicking of all three main mouse buttons, and rotating of the wheel.</p>
<div class="code"><div><div id="highlighter_947048" class="syntaxhighlighter nogutter  xml"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">&lt;</code><code class="xml keyword">Window.InputBindings</code><code class="xml plain">&gt;</code></div><div class="line number2 index1 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">MouseBinding</code> <code class="xml color1">MouseAction</code><code class="xml plain">=</code><code class="xml string">"LeftDoubleClick"</code></div><div class="line number3 index2 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color1">Command</code><code class="xml plain">=</code><code class="xml string">"{Binding MessageCommand}"</code></div><div class="line number4 index3 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color1">CommandParameter</code><code class="xml plain">=</code><code class="xml string">"Left Double Click"</code><code class="xml plain">/&gt;</code></div><div class="line number5 index4 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">MouseBinding</code> <code class="xml color1">MouseAction</code><code class="xml plain">=</code><code class="xml string">"MiddleDoubleClick"</code></div><div class="line number6 index5 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color1">Command</code><code class="xml plain">=</code><code class="xml string">"{Binding MessageCommand}"</code></div><div class="line number7 index6 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color1">CommandParameter</code><code class="xml plain">=</code><code class="xml string">"Middle Double Click"</code><code class="xml plain">/&gt;</code></div><div class="line number8 index7 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">MouseBinding</code> <code class="xml color1">MouseAction</code><code class="xml plain">=</code><code class="xml string">"RightDoubleClick"</code></div><div class="line number9 index8 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color1">Command</code><code class="xml plain">=</code><code class="xml string">"{Binding MessageCommand}"</code></div><div class="line number10 index9 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color1">CommandParameter</code><code class="xml plain">=</code><code class="xml string">"Right Double Click"</code><code class="xml plain">/&gt;</code></div><div class="line number11 index10 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">MouseBinding</code> <code class="xml color1">MouseAction</code><code class="xml plain">=</code><code class="xml string">"WheelClick"</code></div><div class="line number12 index11 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color1">Command</code><code class="xml plain">=</code><code class="xml string">"{Binding MessageCommand}"</code></div><div class="line number13 index12 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color1">CommandParameter</code><code class="xml plain">=</code><code class="xml string">"Wheel Click"</code><code class="xml plain">/&gt;</code></div><div class="line number14 index13 alt1"><code class="xml plain">&lt;/</code><code class="xml keyword">Window.InputBindings</code><code class="xml plain">&gt;</code></div></div></td></tr></tbody></table></div></div></div>
<p>Run the program and try the various mouse actions to see the results. When you double-click or move the mouse wheel, a <a href="http://www.blackwasp.co.uk/WPFMessageBox.aspx">message box</a> will be displayed, showing the action taken.</p>
<div id="ctl00_ctl00_PageContent_PageContent_NextLinkDiv" class="nav"><a href="http://www.blackwasp.co.uk/WPFMouseBindings_2.aspx" id="ctl00_ctl00_PageContent_PageContent_NextLink">Next: Page 2</a></div><div class="editdate">21 June 2015</div></article>
<script src="shCore.js" type="text/javascript"></script>
<script src="shBrushCSharp.js" type="text/javascript"></script>
<script src="shBrushXml.js" type="text/javascript"></script>
<script src="shBrushSql.js" type="text/javascript"></script>
<script type="text/javascript">SyntaxHighlighter.defaults['gutter']=false;SyntaxHighlighter.defaults['quick-code']=false;SyntaxHighlighter.defaults['toolbar']=false;SyntaxHighlighter.defaults['auto-links']=false;SyntaxHighlighter.all();</script>
</div>
<div class="rnav"> 
<a href="http://feeds.feedburner.com/BlackwaspLatestAdditions" target="_top"><img class="navcomm" src="rss.png" alt="RSS Feed"></a><a href="http://twitter.com/BlackwaspUK" target="_top"><img class="navcomm" src="Twitter.png" alt="Twitter"></a><a href="https://profiles.google.com/113882985360066691734" target="_top"><img class="navcomm" src="Google.png" alt="Google+"></a><a href="http://www.facebook.com/BlackWaspUK" target="_top"><img class="navcomm" src="Facebook.png" alt="Facebook"></a><div class="rnavmenu"><a style="border-top: 1px dotted rgb(192, 192, 192); margin-top: 8px;" href="http://www.blackwasp.co.uk/DotNetFrameworkArticles.aspx">.NET Framework</a><a href="http://www.blackwasp.co.uk/AlgorithmsArticles.aspx">Algorithms and Data Structures</a><a href="http://www.blackwasp.co.uk/AudioArticles.aspx">Audio</a><a href="http://www.blackwasp.co.uk/CSharpArticles.aspx">C# Programming</a><a href="http://www.blackwasp.co.uk/ConfigurationArticles.aspx">Configuration</a><a href="http://www.blackwasp.co.uk/DebuggingArticles.aspx">Debugging</a><a href="http://www.blackwasp.co.uk/DesignPatternsArticles.aspx">Design Patterns</a><a href="http://www.blackwasp.co.uk/DocumentationArticles.aspx">Documentation</a><a href="http://www.blackwasp.co.uk/GraphicsArticles.aspx">Graphics</a><a href="http://www.blackwasp.co.uk/IOArticles.aspx">Input / Output</a><a href="http://www.blackwasp.co.uk/LinqArticles.aspx">LINQ</a><a href="http://www.blackwasp.co.uk/NetworkArticles.aspx">Network and Internet</a><a href="http://www.blackwasp.co.uk/ParallelArticles.aspx">Parallel and Asynchronous</a><a href="http://www.blackwasp.co.uk/PerformanceArticles.aspx">Performance</a><a href="http://www.blackwasp.co.uk/ProgrammingConceptsArticles.aspx">Programming Concepts</a><a href="http://www.blackwasp.co.uk/RefactoringArticles.aspx">Refactoring</a><a href="http://www.blackwasp.co.uk/ReferenceSheetArticles.aspx">Reference Sheets</a><a href="http://www.blackwasp.co.uk/ReflectionArticles.aspx">Reflection</a><a href="http://www.blackwasp.co.uk/RegexArticles.aspx">Regular Expressions</a><a href="http://www.blackwasp.co.uk/SecurityArticles.aspx">Security</a><a href="http://www.blackwasp.co.uk/SQLArticles.aspx">SQL Server</a><a href="http://www.blackwasp.co.uk/SystemInfoArticles.aspx">System Information</a><a href="http://www.blackwasp.co.uk/TestingArticles.aspx">Testing</a><a href="http://www.blackwasp.co.uk/ToolsArticles.aspx">Tools</a><a href="http://www.blackwasp.co.uk/VSArticles.aspx">Visual Studio</a><a href="http://www.blackwasp.co.uk/WindowsProgrammingArticles.aspx">Windows Programming</a><a href="http://www.blackwasp.co.uk/WPFArticles.aspx">Windows Presentation Foundation</a><a href="http://www.blackwasp.co.uk/XMLArticles.aspx">XML</a></div>
<div style="border-top: 1px dotted rgb(192, 192, 192);" class="rnavpages"><a href="http://www.blackwasp.co.uk/Copyright.aspx">Â©2006-<span id="ctl00_ctl00_CopyrightYearLabel">2018</span> BlackWasp<br>All Rights Reserved</a><a href="http://www.blackwasp.co.uk/Cookies.aspx">Cookie Policy</a><a href="http://www.blackwasp.co.uk/PrivacyPolicy.aspx">Privacy Policy</a><a href="http://www.blackwasp.co.uk/TermsOfUse.aspx">Terms of Use</a></div></div><div class="footer"></div></div></form><div id="_atssh" style="visibility: hidden; height: 1px; width: 1px; position: absolute; top: -9999px; z-index: 100000;"><iframe src="WPFMouseBindings_3.html" style="height: 1px; width: 1px; position: absolute; top: 0px; z-index: 100000; border: 0px none; left: 0px;" title="AddThis utility frame" id="_atssh705"></iframe></div><div id="_atssh" style="visibility: hidden; height: 1px; width: 1px; position: absolute; top: -9999px; z-index: 100000;"><iframe id="_atssh645" title="AddThis utility frame" style="height: 1px; width: 1px; position: absolute; top: 0px; z-index: 100000; border: 0px none; left: 0px;" src="WPFMouseBindings_4.html"></iframe></div>
<div id="fb-root" class=" fb_reset"><script src="sdk.js" async=""></script><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div><iframe name="fb_xdm_frame_http" allowtransparency="true" allowfullscreen="true" scrolling="no" id="fb_xdm_frame_http" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tabindex="-1" src="WPFMouseBindings_5.html" style="border: medium none;" frameborder="0"></iframe><iframe name="fb_xdm_frame_https" allowtransparency="true" allowfullscreen="true" scrolling="no" id="fb_xdm_frame_https" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tabindex="-1" src="WPFMouseBindings_6.html" style="border: medium none;" frameborder="0"></iframe></div></div><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div></div></div></div><iframe scrolling="no" allowtransparency="true" src="WPFMouseBindings_7.html" style="display: none;" frameborder="0"></iframe><iframe src="WPFMouseBindings_8.html" id="rufous-sandbox" scrolling="no" allowtransparency="true" allowfullscreen="true" style="position: absolute; visibility: hidden; display: none; width: 0px; height: 0px; padding: 0px; border: medium none;" title="Twitter analytics iframe" frameborder="0"></iframe><div id="coFrameDiv" style="height: 0px; display: none;"><iframe id="coToolbarFrame" src="chrome-extension://cjabmdjcfcfdmffimndhafhblfmpjdpe/toolbar/placeholder.html" style="height: 0px; width: 100%; display: none;"></iframe></div><iframe style="display: none;" src="WPFMouseBindings_10.html" allowtransparency="true" scrolling="no" frameborder="0"></iframe></body>
</html>
